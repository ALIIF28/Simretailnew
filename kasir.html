<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Kasir - RetailSIM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.18.0/matter.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="dark-mode.css" rel="stylesheet">
    <style>
        :root {
            --primary-orange: #FF6B35;
            --secondary-coral: #FF8E53;
            --accent-gold: #FFB366;
            --deep-charcoal: #2C3E50;
            --medium-gray: #7F8C8D;
            --light-gray: #ECF0F1;
            --success-green: #27AE60;
            --warning-amber: #F39C12;
            --error-red: #E74C3C;
            --info-blue: #3498DB;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .pos-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .product-card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.2);
            border-color: var(--primary-orange);
        }
        
        .cart-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--primary-orange);
        }
        
        .cart-summary {
            background: linear-gradient(135deg, var(--primary-orange) 0%, var(--secondary-coral) 100%);
            color: white;
            border-radius: 12px;
            padding: 1.5rem;
        }
        
        .search-bar {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
        }
        
        .search-bar:focus {
            outline: none;
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }
        
        .quantity-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: var(--primary-orange);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quantity-btn:hover {
            background: var(--secondary-coral);
            transform: scale(1.1);
        }
        
        .payment-btn {
            background: var(--success-green);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 1rem 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .payment-btn:hover {
            background: #229954;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(39, 174, 96, 0.3);
        }
        
        .barcode-scanner {
            background: #2c3e50;
            color: white;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .barcode-scanner:hover {
            background: #34495e;
        }
        
        .receipt-modal {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }
        
        .receipt-content {
            background: white;
            border-radius: 12px;
            max-width: 400px;
            margin: 2rem;
            padding: 2rem;
        }
        
        .role-badge {
            background: linear-gradient(135deg, var(--primary-orange) 0%, var(--secondary-coral) 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                max-height: 50vh;
            }
            
            .pos-container {
                margin: 1rem;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar fixed top-0 left-0 right-0 z-50 px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <a href="index.html" class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg">SI</span>
                    </div>
                    <span class="text-xl font-semibold text-gray-800">RetailSIM</span>
                </a>
            </div>
            
            <div class="flex items-center space-x-6">
                <div class="role-badge">Kasir</div>
                <div class="text-sm text-gray-600">
                    <span class="font-medium">Devi</span>
                    <div class="text-xs">Aktif</div>
                </div>
                <button class="dark-mode-toggle" onclick="toggleDarkMode()" id="dark-mode-toggle">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" id="toggle-icon">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                <a href="index.html" class="text-gray-600 hover:text-orange-500 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="pt-24 px-6 pb-6">
        <div class="max-w-7xl mx-auto">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Dashboard Kasir</h1>
                <p class="text-gray-600">Sistem POS Touch-Screen untuk transaksi cepat dan akurat</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- POS System -->
                <div class="lg:col-span-2">
                    <div class="pos-container p-6 mb-6">
                        <!-- Search and Scanner -->
                        <div class="flex flex-col md:flex-row gap-4 mb-6">
                            <div class="flex-1">
                                <input type="text" id="product-search" class="search-bar w-full" 
                                       placeholder="Cari produk berdasarkan nama atau barcode...">
                            </div>
                            <div class="barcode-scanner" onclick="simulateBarcodeScan()">
                                <svg class="w-6 h-6 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>
                                </svg>
                                <div class="text-sm">Scan Barcode</div>
                            </div>
                        </div>

                        <!-- Product Grid -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Daftar Produk</h3>
                            <div id="product-grid" class="product-grid">
                                <!-- Products will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Transaction History -->
                    <div class="pos-container p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Transaksi Terakhir</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b">
                                        <th class="text-left py-2">ID Transaksi</th>
                                        <th class="text-left py-2">Tanggal</th>
                                        <th class="text-right py-2">Total</th>
                                        <th class="text-center py-2">Item</th>
                                        <th class="text-center py-2">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="transaction-history">
                                    <!-- Transaction history will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Shopping Cart -->
                <div class="lg:col-span-1">
                    <div class="pos-container p-6 sticky top-28">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Keranjang Belanja</h3>
                        
                        <div id="cart-items" class="mb-6 max-h-64 overflow-y-auto">
                            <div class="text-center text-gray-500 py-8">
                                <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v5a2 2 0 01-2 2H9a2 2 0 01-2-2v-5m6-5V6a2 2 0 00-2-2H9a2 2 0 00-2 2v2"></path>
                                </svg>
                                <p>Keranjang kosong</p>
                                <p class="text-sm">Tambahkan produk untuk memulai transaksi</p>
                            </div>
                        </div>

                        <!-- Cart Summary -->
                        <div class="cart-summary mb-6">
                            <div class="flex justify-between items-center mb-2">
                                <span>Subtotal:</span>
                                <span id="subtotal">Rp 0</span>
                            </div>
                            <div class="flex justify-between items-center mb-2">
                                <span>PPN (10%):</span>
                                <span id="tax">Rp 0</span>
                            </div>
                            <div class="border-t border-white border-opacity-30 pt-2 mb-4">
                                <div class="flex justify-between items-center text-lg font-bold">
                                    <span>Total:</span>
                                    <span id="total">Rp 0</span>
                                </div>
                            </div>
                            
                            <button class="payment-btn" onclick="processPayment()" id="payment-btn" disabled>
                                Proses Pembayaran
                            </button>
                        </div>

                        <!-- Quick Actions -->
                        <div class="space-y-2">
                            <button class="w-full py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors" onclick="clearCart()">
                                Kosongkan Keranjang
                            </button>
                            <button class="w-full py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors" onclick="holdTransaction()">
                                Tahan Transaksi
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receipt-modal" class="receipt-modal fixed inset-0 z-50 hidden flex items-center justify-center">
        <div class="receipt-content">
            <div class="text-center mb-6">
                <h3 class="text-xl font-bold text-gray-800">Struk Pembayaran</h3>
                <p class="text-gray-600">RetailSIM - Sistem Informasi Manajemen Retail</p>
            </div>
            
            <div id="receipt-details" class="mb-6">
                <!-- Receipt details will be populated here -->
            </div>
            
            <div class="flex gap-4">
                <button class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors" onclick="closeReceipt()">
                    Tutup
                </button>
                <button class="flex-1 bg-orange-500 text-white py-2 px-4 rounded-lg hover:bg-orange-600 transition-colors" onclick="printReceipt()">
                    Cetak Struk
                </button>
            </div>
        </div>
    </div>

    <script>
        // Kasir Dashboard JavaScript
        let cart = [];
        let products = [];
        let currentTransaction = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            loadTransactionHistory();
            initializeSearch();
        });

        // Load products
        function loadProducts() {
            // Mock products data
            products = [
                { id: 1, name: 'Indomie Goreng', price: 3500, stock: 150, category: 'Makanan', barcode: '1234567890', image: 'resources/product-1.jpg' },
                { id: 2, name: 'Teh Botol Sosro', price: 5000, stock: 200, category: 'Minuman', barcode: '2345678901', image: 'resources/product-2.jpg' },
                { id: 3, name: 'Sabun Lifebuoy', price: 8000, stock: 80, category: 'Kebersihan', barcode: '3456789012', image: 'resources/product-3.jpg' },
                { id: 4, name: 'Shampoo Sunsilk', price: 15000, stock: 60, category: 'Kebersihan', barcode: '4567890123', image: 'resources/product-4.jpg' },
                { id: 5, name: 'Beras 5kg', price: 45000, stock: 40, category: 'Sembako', barcode: '5678901234', image: 'resources/product-5.jpg' },
                { id: 6, name: 'Minyak Goreng 1L', price: 18000, stock: 90, category: 'Sembako', barcode: '6789012345', image: 'resources/product-1.jpg' },
                { id: 7, name: 'Gula 1kg', price: 12000, stock: 120, category: 'Sembako', barcode: '7890123456', image: 'resources/product-2.jpg' },
                { id: 8, name: 'Roti Tawar', price: 15000, stock: 30, category: 'Makanan', barcode: '8901234567', image: 'resources/product-3.jpg' },
                { id: 9, name: 'Susu UHT', price: 8000, stock: 100, category: 'Minuman', barcode: '9012345678', image: 'resources/product-4.jpg' },
                { id: 10, name: 'Detergen Rinso', price: 25000, stock: 50, category: 'Kebersihan', barcode: '0123456789', image: 'resources/product-5.jpg' },
                { id: 11, name: 'Kopi Nescafe', price: 12000, stock: 75, category: 'Minuman', barcode: '1123456789', image: 'resources/product-1.jpg' },
                { id: 12, name: 'Biskuit Oreo', price: 10000, stock: 90, category: 'Makanan', barcode: '2123456789', image: 'resources/product-2.jpg' }
            ];

            renderProducts(products);
        }

        // Render products
        function renderProducts(productsToRender) {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';

            productsToRender.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => addToCart(product);

                productCard.innerHTML = `
                    <div class="aspect-w-16 aspect-h-12 mb-3">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-32 object-cover rounded-lg">
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-1">${product.name}</h4>
                    <p class="text-sm text-gray-600 mb-2">${product.category}</p>
                    <div class="flex justify-between items-center">
                        <span class="font-bold text-orange-600">${formatCurrency(product.price)}</span>
                        <span class="text-xs text-gray-500">Stok: ${product.stock}</span>
                    </div>
                    <div class="text-xs text-gray-400 mt-1">Barcode: ${product.barcode}</div>
                `;

                grid.appendChild(productCard);
            });
        }

        // Initialize search functionality
        function initializeSearch() {
            const searchInput = document.getElementById('product-search');
            searchInput.addEventListener('input', function(e) {
                const query = e.target.value.toLowerCase();
                const filteredProducts = products.filter(product => 
                    product.name.toLowerCase().includes(query) || 
                    product.barcode.includes(query) ||
                    product.category.toLowerCase().includes(query)
                );
                renderProducts(filteredProducts);
            });
        }

        // Add product to cart
        function addToCart(product) {
            const existingItem = cart.find(item => item.id === product.id);
            
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity += 1;
                } else {
                    showNotification('Stok tidak mencukupi!', 'warning');
                    return;
                }
            } else {
                cart.push({
                    ...product,
                    quantity: 1
                });
            }

            renderCart();
            updateCartSummary();
            showNotification(`${product.name} ditambahkan ke keranjang`, 'success');

            // Animation for adding to cart
            anime({
                targets: event.target,
                scale: [1, 1.1, 1],
                duration: 300,
                easing: 'easeOutCubic'
            });
        }

        // Render cart
        function renderCart() {
            const cartContainer = document.getElementById('cart-items');
            
            if (cart.length === 0) {
                cartContainer.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v5a2 2 0 01-2 2H9a2 2 0 01-2-2v-5m6-5V6a2 2 0 00-2-2H9a2 2 0 00-2 2v2"></path>
                        </svg>
                        <p>Keranjang kosong</p>
                        <p class="text-sm">Tambahkan produk untuk memulai transaksi</p>
                    </div>
                `;
                return;
            }

            cartContainer.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="flex justify-between items-start mb-2">
                        <h5 class="font-medium text-gray-800 text-sm">${item.name}</h5>
                        <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-700">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="flex justify-between items-center">
                        <div class="flex items-center space-x-2">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                            <span class="font-medium">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                        </div>
                        <div class="text-right">
                            <div class="font-semibold text-gray-800">${formatCurrency(item.price * item.quantity)}</div>
                            <div class="text-xs text-gray-500">${formatCurrency(item.price)} each</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Update quantity
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else if (item.quantity > item.stock) {
                    item.quantity = item.stock;
                    showNotification('Stok tidak mencukupi!', 'warning');
                } else {
                    renderCart();
                    updateCartSummary();
                }
            }
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            renderCart();
            updateCartSummary();
        }

        // Update cart summary
        function updateCartSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.1; // 10% tax
            const total = subtotal + tax;

            document.getElementById('subtotal').textContent = formatCurrency(subtotal);
            document.getElementById('tax').textContent = formatCurrency(tax);
            document.getElementById('total').textContent = formatCurrency(total);

            const paymentBtn = document.getElementById('payment-btn');
            paymentBtn.disabled = cart.length === 0;
            paymentBtn.style.opacity = cart.length === 0 ? '0.5' : '1';
        }

        // Clear cart
        function clearCart() {
            cart = [];
            renderCart();
            updateCartSummary();
            showNotification('Keranjang dikosongkan', 'info');
        }

        // Hold transaction
        function holdTransaction() {
            if (cart.length === 0) {
                showNotification('Tidak ada transaksi untuk ditahan', 'warning');
                return;
            }
            
            showNotification('Transaksi ditahan sementara', 'info');
            // In real app, this would save the transaction for later
        }

        // Simulate barcode scan
        function simulateBarcodeScan() {
            const barcode = prompt('Masukkan barcode produk:');
            if (barcode) {
                const product = products.find(p => p.barcode === barcode);
                if (product) {
                    addToCart(product);
                } else {
                    showNotification('Produk tidak ditemukan!', 'error');
                }
            }
        }

        // Process payment
        function processPayment() {
            if (cart.length === 0) return;

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.1;
            const total = subtotal + tax;

            // Generate transaction ID
            const transactionId = 'TRX' + Date.now().toString().slice(-6);
            
            // Create receipt
            showReceipt(transactionId, total);
        }

        // Show receipt
        function showReceipt(transactionId, total) {
            const modal = document.getElementById('receipt-modal');
            const details = document.getElementById('receipt-details');
            
            const now = new Date();
            
            details.innerHTML = `
                <div class="text-center mb-4">
                    <h4 class="font-bold text-lg">${transactionId}</h4>
                    <p class="text-sm text-gray-600">${now.toLocaleDateString('id-ID')} ${now.toLocaleTimeString('id-ID')}</p>
                    <p class="text-sm text-gray-600">Kasir: Ali</p>
                </div>
                
                <div class="border-t border-b py-3 mb-4">
                    ${cart.map(item => `
                        <div class="flex justify-between text-sm mb-1">
                            <span>${item.name} x${item.quantity}</span>
                            <span>${formatCurrency(item.price * item.quantity)}</span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="text-right">
                    <div class="flex justify-between mb-1">
                        <span>Subtotal:</span>
                        <span>${formatCurrency(cart.reduce((sum, item) => sum + (item.price * item.quantity), 0))}</span>
                    </div>
                    <div class="flex justify-between mb-1">
                        <span>PPN (10%):</span>
                        <span>${formatCurrency(cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) * 0.1)}</span>
                    </div>
                    <div class="flex justify-between font-bold text-lg border-t pt-2">
                        <span>Total:</span>
                        <span>${formatCurrency(total)}</span>
                    </div>
                </div>
                
                <div class="text-center mt-6 text-sm text-gray-600">
                    <p>Terima kasih atas kunjungan Anda!</p>
                    <p>Simpan struk ini sebagai bukti pembelian</p>
                </div>
            `;
            
            modal.classList.remove('hidden');
            
            // Animate modal
            anime({
                targets: modal.querySelector('.receipt-content'),
                scale: [0.8, 1],
                opacity: [0, 1],
                duration: 300,
                easing: 'easeOutCubic'
            });
        }

        // Close receipt
        function closeReceipt() {
            const modal = document.getElementById('receipt-modal');
            modal.classList.add('hidden');
            
            // Clear cart and reset
            cart = [];
            renderCart();
            updateCartSummary();
            
            // Reload transaction history
            loadTransactionHistory();
        }

        // Print receipt
        function printReceipt() {
            const receiptContent = document.getElementById('receipt-details').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Struk Pembayaran</title>
                    <style>
                        body { font-family: monospace; margin: 0; padding: 20px; }
                        .text-center { text-align: center; }
                        .text-right { text-align: right; }
                        .font-bold { font-weight: bold; }
                        .border-t { border-top: 1px solid #000; }
                        .border-b { border-bottom: 1px solid #000; }
                        .py-3 { padding: 10px 0; }
                        .mb-4 { margin-bottom: 20px; }
                        .mb-1 { margin-bottom: 5px; }
                        .mt-6 { margin-top: 30px; }
                        .pt-2 { padding-top: 10px; }
                    </style>
                </head>
                <body>
                    ${receiptContent}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
            
            showNotification('Struk dicetak', 'success');
        }

        // Load transaction history
        function loadTransactionHistory() {
            const historyContainer = document.getElementById('transaction-history');
            const transactions = [
                { id: 'TRX001', date: '2025-01-15', total: 85000, items: 5, status: 'completed', cashier: 'Ali' },
                { id: 'TRX002', date: '2025-01-15', total: 120000, items: 8, status: 'completed', cashier: 'Budi' },
                { id: 'TRX003', date: '2025-01-15', total: 45000, items: 3, status: 'pending', cashier: 'Citra' },
                { id: 'TRX004', date: '2025-01-14', total: 200000, items: 12, status: 'completed', cashier: 'Ali' },
                { id: 'TRX005', date: '2025-01-14', total: 75000, items: 4, status: 'completed', cashier: 'Budi' }
            ];

            historyContainer.innerHTML = transactions.map(transaction => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="py-2">${transaction.id}</td>
                    <td class="py-2">${transaction.date}</td>
                    <td class="py-2 text-right">${formatCurrency(transaction.total)}</td>
                    <td class="py-2 text-center">${transaction.items}</td>
                    <td class="py-2 text-center">
                        <span class="px-2 py-1 rounded-full text-xs ${
                            transaction.status === 'completed' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'
                        }">
                            ${transaction.status === 'completed' ? 'Selesai' : 'Pending'}
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        // Utility functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR'
            }).format(amount);
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${
                type === 'success' ? 'bg-green-500' :
                type === 'error' ? 'bg-red-500' :
                type === 'warning' ? 'bg-yellow-500' :
                'bg-blue-500'
            } text-white`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            anime({
                targets: notification,
                translateX: [300, 0],
                opacity: [0, 1],
                duration: 300,
                easing: 'easeOutCubic'
            });
            
            setTimeout(() => {
                anime({
                    targets: notification,
                    translateX: 300,
                    opacity: 0,
                    duration: 300,
                    easing: 'easeInCubic',
                    complete: () => {
                        document.body.removeChild(notification);
                    }
                });
            }, 3000);
        }
    </script>
</body>
</html>

<script>
function saveReceiptAndPrint() {
  const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
  const tax = subtotal * 0.1;
  const total = subtotal + tax;

  const receiptData = {
    transactionId: 'TRX' + Date.now().toString().slice(-6),
    date: new Date().toLocaleDateString('id-ID'),
    cashier: 'Devi', // atau nama kasir dari session
    items: cart.map(item => ({
      name: item.name,
      quantity: item.quantity,
      price: item.price
    })),
    subtotal: Math.round(subtotal),
    tax: Math.round(tax),
    total: Math.round(total)
  };

  localStorage.setItem('receiptData', JSON.stringify(receiptData));
  window.open('struk.html', '_blank', 'width=360,height=600');
}

function printReceipt() {
  saveReceiptAndPrint(); 
}